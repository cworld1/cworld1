{"title":"Alist 自建0成本部署","date":"2022-12-15T02:06:47.000Z","date_formatted":{"ll":"2022年12月15日","L":"2022/12/15","MM-DD":"12-15"},"thumbnail":"https://cdn.cbd.int/cworld-blog@latest/post/deploy-alist/thumbnail.jpg","color":"#2f76d7","link":"post/deploy-alist","comments":true,"tags":["Alist"],"categories":["教程"],"updated":"2023-06-24T07:37:45.975Z","content":"<p>Alist 是一款支持多种存储的目录文件列表程序，后端基于 <code>gin</code>，前端使用 <code>react</code>。</p>\n<span id=\"more\"></span>\n<p>这里提供 Alist 官方的传送门：<a href=\"https://github.com/alist-org/alist\" target=\"_blank\">Github</a> | <a href=\"https://pan.nn.ci/\" target=\"_blank\">Demo</a> | <a href=\"https://alist.nn.ci/zh/\" target=\"_blank\">文档</a></p>\n<p>不过本节将重点讨论使用 Render 部署 Alist 的方法。</p>\n<h2 id=\"fork-仓库\">Fork 仓库<a title=\"#fork-仓库\" href=\"#fork-仓库\"></a></h2>\n<p>首先，我们需要 Fork 一份 Alist-render 的仓库。（不会的自己使用搜索引擎）</p>\n<p>Alist 仓库地址：<a href=\"https://github.com/alist-org/alist-render\" target=\"_blank\">Github</a></p>\n<h2 id=\"修改配置\">修改配置<a title=\"#修改配置\" href=\"#修改配置\"></a></h2>\n<p>前往 fork 的仓库，修改 render.yaml 内的 <code>repo</code> 配置为自己的仓库地址。</p>\n<h2 id=\"创建数据库\">创建数据库<a title=\"#创建数据库\" href=\"#创建数据库\"></a></h2>\n<p>Alist 需要一个数据库，可选 sqlite3、mysql、postgres。这里选用提供免费服务的 <a href=\"https://www.elephantsql.com/\" target=\"_blank\">ElephantSQL</a>。</p>\n<p>进入官网：<a href=\"https://www.elephantsql.com/\" target=\"_blank\">ElephantSQL</a>，点击位于页面中央的 <code>Get a managed database today</code></p>\n<p><img src=\"https://cdn.cbd.int/cworld-blog@latest/post/deploy-alist/62a5ea8d2548b.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<p>选择海龟样子的 <code>Free</code> 计划</p>\n<p><img src=\"https://cdn.cbd.int/cworld-blog@latest/post/deploy-alist/62a5eab45c34f.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<p>会进入登陆页面，可以使用 Github 进行授权登陆。之后会来到控制台，我们选择绿色的 <code>Create New Instance</code> 创建一个新的数据库。名称和 Tag 随意填写，方案是默认的 Free 方案。</p>\n<p><img src=\"https://cdn.cbd.int/cworld-blog@latest/post/deploy-alist/1671194703990.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<p>接下来的地区可以随意选择，优先选择高亮的地区；如我选的 <code>AP-East-1 (Hong Kong)</code>。这样我们就获得了一个免费的 <code>postgres</code> 类型的数据库。注意详情页的如下配置，后面会用到。</p>\n<p><img src=\"https://cdn.cbd.int/cworld-blog@latest/post/deploy-alist/1671195753013.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"render-部署\">Render 部署<a title=\"#render-部署\" href=\"#render-部署\"></a></h2>\n<p>进入官网：<a href=\"https://render.com/\" target=\"_blank\">Render</a>，点击右上角的 <code>GET STARTED</code> 注册账号。</p>\n<p>注册完成后，点击右上角的 <code>New +</code>，选择 <code>Web Service</code>，并在授权 Github 时连接刚刚 Fork 的 Alist 仓库。</p>\n<p><img src=\"https://cdn.cbd.int/cworld-blog@latest/post/deploy-alist/1671195753256.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<p>下一步先随便取个名字，然后拉到底部点击 <code>Advanced</code>，录入需要的环境变量。</p>\n<p><img src=\"https://cdn.cbd.int/cworld-blog@latest/post/deploy-alist/1671196295276.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<div class=\"φbq\"><div class=\"φbs\"><table><thead>\n<tr>\n<th style=\"text-align:center\">变量参数</th>\n<th style=\"text-align:center\">示例参数</th>\n<th style=\"text-align:center\">数据库详情页对应</th>\n<th style=\"text-align:center\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">DB_HOST</td>\n<td style=\"text-align:center\"><a href=\"http://queenie.db.elephantsql.com\">queenie.db.elephantsql.com</a></td>\n<td style=\"text-align:center\">Server</td>\n<td style=\"text-align:center\">数据库地址</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">DB_NAME</td>\n<td style=\"text-align:center\">bkqgx</td>\n<td style=\"text-align:center\">User &amp; Default database</td>\n<td style=\"text-align:center\">数据库名字</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">DB_PASS</td>\n<td style=\"text-align:center\">5CqBjEVZWdaaad2333aadadadadN3Clo</td>\n<td style=\"text-align:center\">Password</td>\n<td style=\"text-align:center\">数据库密码</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">DB_PORT</td>\n<td style=\"text-align:center\">5432</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">数据库端口</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">DB_SSL_MODE</td>\n<td style=\"text-align:center\">disable</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">SSL 模式</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">DB_TYPE</td>\n<td style=\"text-align:center\">postgres</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">数据库类型</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">DB_USER</td>\n<td style=\"text-align:center\">bkqgx</td>\n<td style=\"text-align:center\">User &amp; Default database</td>\n<td style=\"text-align:center\">数据库用户名</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">PORT</td>\n<td style=\"text-align:center\">8080</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">端口</td>\n</tr>\n</tbody>\n</table></div></div><details><summary>关于 DB_SSL_MODE</summary><p>用于给数据连接提供 SSL 加密保护。其中：</p>\n<ul>\n<li>sqlite3 数据库：请忽略该参数</li>\n<li>mysql 数据库：参数有 <code>true</code>, <code>false</code>, <code>skip-verify</code>, <code>preferred</code>, 选一个填</li>\n<li>postgres 数据库：参数有 <code>disable</code>，<code>allow</code>，<code>prefer</code>，<code>require</code>，<code>verify-full</code>，选一个填</li>\n</ul>\n<p>我用的 postgres 数据库填的是 <code>disable</code>，也就是没用 SSL；大家按需选择即可。</p>\n</details><p>注：为了提升访问速度，建议额外配置环境变量 <code>CDN</code> 为 <code>https://npm.elemecdn.com/alist-web@【NPM官网查到的最新版本号】/dist/</code>，能一定程度上加快网页打开速度。</p>\n<h2 id=\"保持唤醒\">保持唤醒<a title=\"#保持唤醒\" href=\"#保持唤醒\"></a></h2>\n<p>由于 Render 15 分钟没访问会休眠，所以我们可以注册一个 <a href=\"https://uptimerobot.com/\" target=\"_blank\">Uptimerobot</a> 或 <a href=\"https://www.checklyhq.com/\" target=\"_blank\">Checklyhq</a> 类似的这种监视网站，添加一个监控，24 小时定时访问 render 上的项目，render 就不会休眠了。</p>\n<blockquote>\n<p>Render 原本的免费计划是每月允许总共使用 750 小时，似乎是不计流量的，就部署一个项目来说完全够用。但是 render 官方宣布定价将从 2023 年 1 月 1 日开始更改，从每月使用 750 小时，改为了每月免费带宽 100GB 的流量。</p>\n</blockquote>\n<h2 id=\"问题解决\">问题解决<a title=\"#问题解决\" href=\"#问题解决\"></a></h2>\n<p>由于搭建的人开始变多，Render 官方也开始对 Alist 项目进行限制，导致部分人无法正常部署。解决方案：</p>\n<ul>\n<li>修改自己的仓库名，避免出现 Alist 字眼；</li>\n<li>将 <code>render.yaml</code> 中的 <code>repo</code> 配置为自己的仓库地址。</li>\n</ul>\n<p>最后感谢 <a href=\"https://www.zxma.top/\" target=\"_blank\">檐牙</a> 提供的<a href=\"https://www.zxma.top/posts/438365eb\" target=\"_blank\">参考</a>。</p>\n","prev":{"title":"ChatGPT 深度使用与日用方案","link":"post/chatgpt"},"next":{"title":"米哈游游戏（原神/崩坏3）自动签到","link":"post/mihoyo-helper"},"plink":"https://blog.cworld.top/post/deploy-alist/","toc":[{"id":"fork-仓库","title":"Fork 仓库","index":"1"},{"id":"修改配置","title":"修改配置","index":"2"},{"id":"创建数据库","title":"创建数据库","index":"3"},{"id":"render-部署","title":"Render 部署","index":"4"},{"id":"保持唤醒","title":"保持唤醒","index":"5"},{"id":"问题解决","title":"问题解决","index":"6"}],"reward":true,"copyright":{"updated":"2023年6月24日","author":"CWorld","link":"<a href=\"https://blog.cworld.top/post/deploy-alist/\" title=\"Alist 自建0成本部署\">https://blog.cworld.top/post/deploy-alist/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" rel=\"external nofollow noopener\" target=\"_blank\">CC BY-NC-ND 4.0</a>)"},"reading_time":"912 字约 6 分钟"}