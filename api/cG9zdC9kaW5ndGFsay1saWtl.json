{"title":"钉钉一键点赞（最高 21 亿）","date":"2020-03-03T23:21:47.000Z","date_formatted":{"ll":"2020年3月3日","L":"2020/03/03","MM-DD":"03-03"},"thumbnail":"https://cdn.cbd.int/cworld-blog@latest/post/dingtalk-like/thumbnail.jpg","color":"#640D80","link":"post/dingtalk-like","comments":true,"tags":["DingTalk","Fiddler","JavaScript"],"categories":["教程"],"updated":"2023-06-13T12:53:25.145Z","content":"<p>想必感兴趣的已经试过了连点器的畅快吧。在玩转这之前，这确实不失为一种强有力的手段。<span id=\"more\"></span>然而如果这样的话，最多也就不过十万。这怎么能让博主折服呢，所以就从钉钉直播下手。在这之前，先对这个套壳钉钉有一个更深入的了解。</p>\n<h2 id=\"思路分析\">思路分析<a title=\"#思路分析\" href=\"#思路分析\"></a></h2>\n<h3 id=\"运行逻辑\">运行逻辑<a title=\"#运行逻辑\" href=\"#运行逻辑\"></a></h3>\n<p>先研究一下点赞的运行逻辑：</p>\n<p><img src=\"https://cdn.cbd.int/cworld-blog@latest/post/dingtalk-like/hrtsmcgmj30wu08wwja.jpg\" alt=\"点赞逻辑\" loading=\"lazy\" class=\"φbp\"></p>\n<p>由于钉钉的客户端中的网络通讯加密，点赞数上传也不例外，所以我们从直播间网页上下功夫。</p>\n<p>直播间所用网页：<a href=\"https://h5.m.taobao.com/tblive/dingtalk/pc-live-v3.html\" target=\"_blank\">钉钉直播间</a></p>\n<blockquote>\n<p>注意：钉钉加载直播间的弹出窗口实际上是一个浏览器，其网络通讯可以被 Fiddler 获取到，亦可以通过其 Autoresponder 功能替换为本地文件，这就是我们的突破口。</p>\n</blockquote>\n<h3 id=\"目标流程\">目标流程<a title=\"#目标流程\" href=\"#目标流程\"></a></h3>\n<p><img src=\"https://cdn.cbd.int/cworld-blog@latest/post/dingtalk-like/hsdqms0bj30w008o42u.jpg\" alt=\"目标\" loading=\"lazy\" class=\"φbp\"></p>\n<p>其中不对 favorCount 进行自增是为了确保赞数确实上传到服务器并进行了累加，这样会导致点击之后到数值显示有一定的延迟，一般在几秒钟。此时我们看到点击一次点赞按钮到一定时间后（源文件中是 1000ms ）将会触发上传操作。</p>\n<h2 id=\"具体实现\">具体实现<a title=\"#具体实现\" href=\"#具体实现\"></a></h2>\n<h3 id=\"理论实践\">理论实践<a title=\"#理论实践\" href=\"#理论实践\"></a></h3>\n<p>首先根据原理准备网页文件，下载直播间代码。</p>\n<p>打开上述网址，<code>Ctrl + S</code> 保存。注意我们只需要 html 文件。</p>\n<p><img src=\"https://cdn.cbd.int/cworld-blog@latest/post/dingtalk-like/htjjkwiaj30p50973zi.jpg\" alt=\"image\" loading=\"lazy\" class=\"φbp\"></p>\n<p>搜索 uploadLikesClick 字段，将看到一个函数。</p>\n<p><img src=\"https://cdn.cbd.int/cworld-blog@latest/post/dingtalk-like/htqqvj2uj30gg03jgm6.jpg\" alt=\"image\" loading=\"lazy\" class=\"φbp\"></p>\n<p>注意两个画框的地方，它们就是要修改的核心。</p>\n<p>这样一来就可以直接修改了。将第一个框中的内容改为：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">uploadLikesClick</span>(B, <span class=\"number\">10000000</span>);</span><br></pre></td></tr></table></figure>\n<p>第二个框中的 1e4 即为上传间隔，赋值为 0 即为清零操作。</p>\n<p>故我们可以做到如下图一般的骚操作：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">uploadLikesClick</span>(B,<span class=\"title class_\">Math</span>.<span class=\"title function_\">ceil</span>(<span class=\"number\">10000000</span>*<span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>()+<span class=\"number\">1</span>)),t.<span class=\"property\">favorCountCache</span>=<span class=\"number\">1</span>)&#125;,<span class=\"number\">1e2</span>)</span><br></pre></td></tr></table></figure>\n<p>至此理论部分结束。如有技术可以自己实现了。经过实验钉钉存赞数的变量为 32 位有符号 int 其最大值约为 21 亿左右，超出后变成负值，直播间会显示为 0 。如果还有人点赞，赞数会增加但是 -21 亿没什么人会点的过来的…除了这样改。</p>\n<blockquote>\n<p>Ps. 10000000 好像是最大值了。</p>\n</blockquote>\n<h3 id=\"fiddler-修改\">Fiddler 修改<a title=\"#fiddler-修改\" href=\"#fiddler-修改\"></a></h3>\n<ol>\n<li>首先你需要下载并修改好直播间网页并将其保存在本地。</li>\n<li>安装 <a href=\"https://www.telerik.com/download/fiddler\" target=\"_blank\">Fiddler</a> 。</li>\n<li>打开 Fiddler 的 HTTPS 模式，位于 Tools - Options - HTTPS 。<br>\n<img src=\"https://cdn.cbd.int/cworld-blog@latest/post/dingtalk-like/iaaqmxk8j30f20a8mxk.jpg\" alt=\"image\" loading=\"lazy\"></li>\n<li>配置 Autoresponder ，即在测试环境中将在线网页强制替换为本地网页。<br>\n<img src=\"https://cdn.cbd.int/cworld-blog@latest/post/dingtalk-like/iaf10k3gj30fz08474s.jpg\" alt=\"image\" loading=\"lazy\"></li>\n<li>打开清理钉钉的网页缓存，位于%LOCALAPPDATA%\\DIngtalk\\Cache，删除全部 f 开头的文件。\n<blockquote>\n<p><code>%LOCALAPPDATA%</code> 为 <code>C:\\Users\\你的电脑用户名\\AppData\\Local</code><br>\nPs. 此步骤需在每次 <strong>更改网页文件后和重新打开直播间之前</strong> 完成，否则会导致替换失败。</p>\n</blockquote>\n</li>\n<li>打开钉钉直播间，如果遇到错误没关系，多打开几次，当播放正常之后，点赞吧。</li>\n</ol>\n<h3 id=\"效果展示\">效果展示<a title=\"#效果展示\" href=\"#效果展示\"></a></h3>\n<p><img src=\"https://cdn.cbd.int/cworld-blog@latest/post/dingtalk-like/ib1q0zv7j31ww0zcgxc.jpg\" alt=\"image\" loading=\"lazy\" class=\"φbp\"></p>\n<h3 id=\"注意事项\">注意事项<a title=\"#注意事项\" href=\"#注意事项\"></a></h3>\n<p>为了避免视频界面缓存问题，我们将大部分缓存都清除了，这会使直播界面甚至其他界面需要重载缓存，因此清理后很多界面需要二次打开才能加载。</p>\n<p>同时需要注意的是，点赞仅供娱乐。请勿过分贪玩，适度为止。</p>\n<h2 id=\"主播禁用点赞的问题\">主播禁用点赞的问题<a title=\"#主播禁用点赞的问题\" href=\"#主播禁用点赞的问题\"></a></h2>\n<p>根据测试，禁用功能应该是最近研发的，而相关代码似乎是直接追加到最后的，所以趁直播界面加载完毕之前，拟好点赞位置猛击，就会发现还是可以卡的出几个赞的。如果你需要更快的点赞方式，建议使用 <a href=\"https://www.shudaxia.com/\" target=\"_blank\">鼠大侠</a> 等软件，帮助你更快地在加载的片刻迅速点赞。</p>\n","prev":{"title":"酷安 318 事件","link":"post/coolapk-318"},"next":{"title":"钉钉云课堂提取视频 & 倍速播放 & 学习进度","link":"post/dingtalk-player"},"plink":"https://blog.cworld.top/post/dingtalk-like/","toc":[{"id":"思路分析","title":"思路分析","index":"1","children":[{"id":"运行逻辑","title":"运行逻辑","index":"1.1"},{"id":"目标流程","title":"目标流程","index":"1.2"}]},{"id":"具体实现","title":"具体实现","index":"2","children":[{"id":"理论实践","title":"理论实践","index":"2.1"},{"id":"fiddler-修改","title":"Fiddler 修改","index":"2.2"},{"id":"效果展示","title":"效果展示","index":"2.3"},{"id":"注意事项","title":"注意事项","index":"2.4"}]},{"id":"主播禁用点赞的问题","title":"主播禁用点赞的问题","index":"3"}],"reward":true,"copyright":{"updated":"2023年6月13日","author":"CWorld","link":"<a href=\"https://blog.cworld.top/post/dingtalk-like/\" title=\"钉钉一键点赞（最高 21 亿）\">https://blog.cworld.top/post/dingtalk-like/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" rel=\"external nofollow noopener\" target=\"_blank\">CC BY-NC-ND 4.0</a>)"},"reading_time":"1062 字约 7 分钟"}