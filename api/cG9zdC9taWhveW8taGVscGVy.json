{"title":"米哈游游戏（原神/崩坏3）自动签到","date":"2022-04-17T17:10:14.000Z","date_formatted":{"ll":"2022年4月17日","L":"2022/04/17","MM-DD":"04-17"},"link":"post/mihoyo-helper","comments":true,"tags":["Python","云函数","米哈游"],"categories":["教程"],"updated":"2022-11-09T02:53:48.588Z","content":"<p>这是一个关于 <a href=\"https://github.com/y1ndan/genshinhelper2\" target=\"_blank\">原神签到小助手</a> 的指导教程。</p>\n<span id=\"more\"></span>\n<p>写这个文档，是因为开发者自己写的文档太乱了。我也花了很长时间才彻底看懂。。</p>\n<h2 id=\"项目相关\">项目相关<a title=\"#项目相关\" href=\"#项目相关\"></a></h2>\n<blockquote>\n<p>genshinhelper 从v2.0.0开始，分为 genshinhelper2 和 genshin-checkin-helper 两个项目，同时分离出 onepush 推送包。</p>\n</blockquote>\n<h3 id=\"前言\">前言<a title=\"#前言\" href=\"#前言\"></a></h3>\n<p>原神是少有的游戏本体和签到福利分离的游戏，玩家为了签到还要额外下载米游社 App。</p>\n<p>平心而论，目前的每日签到奖励真的不咋地，都知道是蚊子腿。事实上，你完全可以选择无视签到，不签也没啥大的损失；或者选择手动签到，但这样的话哪天忘记打卡了就很头疼。</p>\n<p>为了原石、摩拉和紫色经验书等签到奖励，这个项目应运而生，可以实现自动每日签到。</p>\n<h3 id=\"简介\">简介<a title=\"#简介\" href=\"#简介\"></a></h3>\n<p><code>genshinhelper</code>（原神签到小助手），前身为 <code>genshin-impact-helper</code>，可以自动化为你获取原神每日福利。</p>\n<h3 id=\"功能支持\">功能支持<a title=\"#功能支持\" href=\"#功能支持\"></a></h3>\n<ul>\n<li>支持订阅推送</li>\n<li>支持多个账号以及一个账号下的多个角色</li>\n<li>米游社原神/崩坏3的每日签到</li>\n<li>米游社的米游币获取任务</li>\n<li>原神超话功能 活动监测 + 领兑换码 + 多方推送</li>\n<li>支持原神多种服务器（天空岛/世界树/America/Europe/Asia/SAR）</li>\n<li>原神微信积分商城签到</li>\n<li>云原神时长活动签到</li>\n</ul>\n<h3 id=\"源码\">源码<a title=\"#源码\" href=\"#源码\"></a></h3>\n<ul>\n<li>\n<p>genshinhelper2（<a href=\"https://github.com/y1ndan/genshinhelper2\" target=\"_blank\">Github</a> | <a href=\"https://gitlab.com/y1ndan/genshinhelper2\" target=\"_blank\">Gitlab</a>）- 签到相关的封装库，不能开箱即用。</p>\n</li>\n<li>\n<p><a href=\"https://gitlab.com/y1ndan/genshin-checkin-helper\" target=\"_blank\">genshin-checkin-helper</a> - 签到主程序。</p>\n</li>\n<li>\n<p><a href=\"https://github.com/y1ndan/onepush\" target=\"_blank\">onepush</a> - 一个简单易用的推送包。</p>\n</li>\n</ul>\n<h2 id=\"运行方式与环境搭建\">运行方式与环境搭建<a title=\"#运行方式与环境搭建\" href=\"#运行方式与环境搭建\"></a></h2>\n<p><img src=\"https://cdn.jsdelivr.net/gh/cworld1/cworld1@gh-pages/post/mihoyo-helper/runway-choose.jpg\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<details><summary>方案1 终端运行</summary><p>终端运行 <code>genshinhelper</code> or <code>python -m genshinhelper</code>可以直接运行签到脚本。</p>\n</details><details><summary>方案2 云函数运行（推荐）</summary><blockquote>\n<p>注意：<code>v1.5.0+</code> 版本增加了随机延迟功能，默认为10-300s。故云函数的<code>执行超时时间</code>应设置为大于变量中的 <code>MAX_SLEEP_SECS</code>（最大休眠秒数）。</p>\n</blockquote>\n<p>这里以腾讯云函数为例。阿里云方法类似。</p>\n<p><a href=\"https://wwa.lanzoui.com/b07mk6dla\" target=\"_blank\">云函数版文件下载</a> 密码：ed03</p>\n<p>前往 <a href=\"https://console.cloud.tencent.com/scf/\" target=\"_blank\">云函数 SCF 管理控制台</a> --&gt;<code>函数服务</code>–&gt;<code>新建</code>–&gt;<code>自定义创建</code>–&gt;<code>基础配置</code>–&gt;<code>本地上传zip包</code>–&gt;<code>上传</code>–&gt;<code>本地上传zip包</code>–&gt; 选择下载的<code>genshinhelper-xxx-serverless.zip</code>压缩包–&gt;<code>完成</code></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/cworld1/cworld1@gh-pages/post/mihoyo-helper/new-server.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<p>前往<code>genshinhelper</code>–&gt;<code>函数管理</code>–&gt;<code>函数配置</code>–&gt;<code>编辑</code></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/cworld1/cworld1@gh-pages/post/mihoyo-helper/edit-config.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<p>此处可以编辑环境变量。同时建议修改<code>执行超时时间</code>为<code>600</code>秒。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/cworld1/cworld1@gh-pages/post/mihoyo-helper/add-variables.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n<p>前往<code>genshinhelper</code>–&gt;<code>触发管理</code>–&gt;<code>新建触发器</code>–&gt; 按下图进行配置。当然你也可以添加一个 <code>API 网关</code>，方便手动强制执行。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/cworld1/cworld1@gh-pages/post/mihoyo-helper/triggers.png\" alt=\"\" loading=\"lazy\" class=\"φbp\"></p>\n</details><details><summary>方案3 Docker 运行</summary><p>使用以下命令拉取镜像：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull yindan/genshinhelper</span><br></pre></td></tr></table></figure>\n<p>你也可以在 <a href=\"https://registry.hub.docker.com/r/yindan/genshinhelper/\" target=\"_blank\">Docker Hub</a> 上找到该仓库。</p>\n<p>在下列命令中， <code>COOKIE_MIHOYOBBS</code> 代表环境变量名字， <code>&lt;COOKIE_MIHOYOBBS&gt;</code> 代表 <code>COOKIE_MIHOYOBBS</code> 对应的值；<code>DISCORD_WEBHOOK</code> 同理。</p>\n<blockquote>\n<p>应当注意，这里的 <code>COOKIE_MIHOYOBBS</code>和 <code>DISCORD_WEBHOOK</code>只是教程使用的例子，并非必须字段。<br>\n如果你是国际服则应该配置 <code>COOKIE_HOYOLAB</code>而不是 <code>COOKIE_MIHOYOBBS</code>；不使用Discord推送，可以不配置 <code>DISCORD_WEBHOOK</code>。</p>\n</blockquote>\n<ul>\n<li>基本使用</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d --name=genshinhelper \\</span><br><span class=\"line\">-e COOKIE_MIHOYOBBS=<span class=\"string\">&quot;&lt;COOKIE_MIHOYOBBS&gt;&quot;</span> \\</span><br><span class=\"line\">-e DISCORD_WEBHOOK=<span class=\"string\">&quot;&lt;DISCORD_WEBHOOK&gt;&quot;</span> \\</span><br><span class=\"line\">--restart always \\</span><br><span class=\"line\">yindan/genshinhelper:latest</span><br></pre></td></tr></table></figure>\n<ul>\n<li>高级使用</li>\n</ul>\n<p>Docker 会在每天早上 <code>6:00</code> 触发签到任务。可以使用 <code>CRON_SIGNIN</code> 参数自定义触发时间。</p>\n<p>例如触发时间使用的是北京时间：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d --name=genshinhelper \\</span><br><span class=\"line\">-e COOKIE_MIHOYOBBS=<span class=\"string\">&quot;&lt;COOKIE_MIHOYOBBS&gt;&quot;</span> \\</span><br><span class=\"line\">-e DISCORD_WEBHOOK=<span class=\"string\">&quot;&lt;DISCORD_WEBHOOK&gt;&quot;</span> \\</span><br><span class=\"line\">-e CRON_SIGNIN=<span class=\"string\">&quot;0 7 * * *&quot;</span> \\</span><br><span class=\"line\">--restart always \\</span><br><span class=\"line\">yindan/genshinhelper:latest</span><br></pre></td></tr></table></figure>\n<p>如果你想使用 <code>config.json</code> 配置文件（这部分会在 <code>配置</code>章节讲解），则可以使用以下命令映射文件夹。</p>\n<p>假设你的配置文件位于 <code>/etc/genshin/config.json</code>。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d --name=genshinhelper \\</span><br><span class=\"line\">-v /etc/genshin:/app/genshincheckinhelper/config \\</span><br><span class=\"line\">--restart always \\</span><br><span class=\"line\">yindan/genshinhelper:latest</span><br></pre></td></tr></table></figure>\n<ul>\n<li>常用命令</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看日志</span></span><br><span class=\"line\">$ docker logs -f genshinhelper --<span class=\"built_in\">tail</span> 100</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 重启</span></span><br><span class=\"line\">$ docker restart genshinhelper</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 更新</span></span><br><span class=\"line\">$ docker pull yindan/genshinhelper</span><br><span class=\"line\">$ docker <span class=\"built_in\">rm</span> -f genshinhelper</span><br><span class=\"line\"><span class=\"comment\"># 之后依据基本使用或高级使用重新部署</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 卸载</span></span><br><span class=\"line\">$ docker <span class=\"built_in\">rm</span> -f genshinhelper</span><br><span class=\"line\">$ docker image <span class=\"built_in\">rm</span> genshinhelper</span><br></pre></td></tr></table></figure>\n</details><details><summary>方案4 使用 PyPI Package 运行</summary><p>使用 <a href=\"https://pypi.org/project/genshinhelper/\" target=\"_blank\">pypi包</a> 进行安装：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install genshinhelper</span><br></pre></td></tr></table></figure>\n<p>你需要先在主机中添加环境变量，或者使用 <code>pip show genshinhelper</code> 查看包的安装位置，找到并编辑 <code>config.json</code> 配置文件。</p>\n<p>如果你已经完成前置要求，使用以下命令运行项目:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python -m genshinhelper</span><br></pre></td></tr></table></figure>\n</details><h2 id=\"配置与操作\">配置与操作<a title=\"#配置与操作\" href=\"#配置与操作\"></a></h2>\n<h3 id=\"配置项\">配置项<a title=\"#配置项\" href=\"#配置项\"></a></h3>\n<p>其实就是云函数里面的环境变量或者其他方式下的 Config 文件。</p>\n<p>下面的配置项并非每一项都要填写，根据需要填即可。</p>\n<div class=\"φbq\"><div class=\"φbs\"><table><thead>\n<tr>\n<th style=\"text-align:left\">变量名</th>\n<th style=\"text-align:center\">默认值</th>\n<th style=\"text-align:left\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">LANGUAGE</td>\n<td style=\"text-align:center\">en</td>\n<td style=\"text-align:left\">项目语言。目前支持中文(zh)和英文(en)。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">MAX_SLEEP_SECS</td>\n<td style=\"text-align:center\">300</td>\n<td style=\"text-align:left\">最大休眠秒数。自v1.5.0添加了运行前随机延迟，设置此参数可自定义延迟，秒数应该＞10</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">RANDOM_SLEEP_SECS_RANGE</td>\n<td style=\"text-align:center\">0-300</td>\n<td style=\"text-align:left\">随机延迟休眠秒数范围。设置成&quot;0-0&quot;为取消延迟</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">RUN_ENV</td>\n<td style=\"text-align:center\">prod</td>\n<td style=\"text-align:left\">是否延迟执行。设置为任意非默认值即可跳过随机延迟</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">CHECK_IN_TIME</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:left\">（云函数无需配置此项）每日签到时间，只运行环境的时间有关。对于 Docker 可以用 TZ=Asia/Shanghai 设置时区</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">CHECK_RESIN_SECS</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:left\">（云函数无需配置此项）原神原粹树脂检测间隔秒数</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">ONE_PUSH</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:left\">设置消息推送</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">COOKIE_MIHOYOBBS</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:left\">米游社里原神签到需要的 Cookie 值</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">COOKIE_BH3</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:left\">崩坏3签到需要的 Cookie 值</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">COOKIE_MIYOUBI</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:left\">米游社执行任务获取米游币需要的 Cookie 值</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">COOKIE_HOYOLAB</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:left\">HoYoLAB 里原神签到需要的 Cookie 值</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">COOKIE_WEIBO</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:left\">微博超话自动签到需要的 Cookie 值，形如 <code>aid=xxx;gsid=xxx;s=xxx;from=xxx</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">COOKIE_KA</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:left\">超话活动追踪\\获取兑换码需要的 Cookie 值，形如 <code>SUB=xxx;SUBP=xxx</code></td>\n</tr>\n<tr>\n<td style=\"text-align:left\">CLOUD_GENSHIN</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:left\">云原神签到得时长需要的 Cookie 值</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">COOKIE_RESIN_TIMER</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:left\">原神原粹树脂检测需要的 Cookie 值</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">SHOPTOKEN</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:left\">原神微信积分商城的 token 值（通过抓包获取）</td>\n</tr>\n</tbody>\n</table></div></div><blockquote>\n<p>Cookie 相关配置项都可以填写多个账号。不同账号的 Cookie 值之间用<code>#</code>分隔，如：<code>cookie1#cookie2#cookie3</code></p>\n</blockquote>\n<h3 id=\"配置文件\">配置文件<a title=\"#配置文件\" href=\"#配置文件\"></a></h3>\n<p>对于云函数就是环境变量，所以无需配置文件。</p>\n<p>例如只配置原神签到福利和 Discord 推送，那么配置文件除了保持完整也可以写成：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;COOKIE_MIHOYOBBS&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;DISCORD_WEBHOOK&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"获取-cookie\">获取 Cookie<a title=\"#获取-cookie\" href=\"#获取-cookie\"></a></h3>\n<p>你可以通过书签法执行 JS 代码。</p>\n<p>JS 代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">javascript</span>:(<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;<span class=\"keyword\">let</span> domain=<span class=\"variable language_\">document</span>.<span class=\"property\">domain</span>;<span class=\"keyword\">let</span> cookie=<span class=\"variable language_\">document</span>.<span class=\"property\">cookie</span>;<span class=\"title function_\">prompt</span>(<span class=\"string\">&#x27;Cookies: &#x27;</span>+domain, cookie)&#125;)();</span><br></pre></td></tr></table></figure>\n<p>你可以直接在开发者工具的 Console 面板直接粘贴运行，也可以将下面的链接收藏为书签（电脑拖拽到书签栏，手机需要手动添加）：</p>\n<p><a href=\"javascript:(function(){let domain=document.domain;let cookie=document.cookie;prompt('Cookies: '+domain, cookie)})();\">获取Cookie</a></p>\n<h2 id=\"签到相关详解\">签到相关详解<a title=\"#签到相关详解\" href=\"#签到相关详解\"></a></h2>\n<h3 id=\"原神、崩坏3、米游社签到\">原神、崩坏3、米游社签到<a title=\"#原神、崩坏3、米游社签到\" href=\"#原神、崩坏3、米游社签到\"></a></h3>\n<p>对于 <code>COOKIE_MIHOYOBBS</code>、<code>COOKIE_BH3</code>、<code>COOKIE_MIYOUBI</code> 的 Cookie 值抓取，都可以直接前往米游社网站 <a href=\"https://bbs.mihoyo.com/ys/\" target=\"_blank\">https://bbs.mihoyo.com/ys/</a> 或 <a href=\"https://bbs.mihoyo.com/bh3/%E3%80%82\" target=\"_blank\">https://bbs.mihoyo.com/bh3/。</a></p>\n<p>如果是 HoYoLAB，请前往 <a href=\"https://webstatic-sea.mihoyo.com/ys/event/signin-sea/index.html?act_id=e202102251931481&amp;lang=en-us\" target=\"_blank\">https://webstatic-sea.mihoyo.com/ys/event/signin-sea/index.html?act_id=e202102251931481&amp;lang=en-us</a> 页面抓取并填入 <code>COOKIE_HOYOLAB</code>。</p>\n<blockquote>\n<p>上述 Cookie 应包含 <code>account_id</code> 和 <code>cookie_token</code> 两个字段。如果没有，建议使用浏览器的无痕/访客/隐私模式重新登陆访问。</p>\n</blockquote>\n<h3 id=\"微博超话签到\">微博超话签到<a title=\"#微博超话签到\" href=\"#微博超话签到\"></a></h3>\n<p><code>COOKIE_WEIBO</code> 参数需要在 <strong>微博国际版 APP</strong> 内抓包取得。抓包时使用微博的搜索功能就能轻松获得相应请求，但请注意抓包地址为 https。</p>\n<p>地址形如：<code>https://api.weibo.cn/2/xxxxxx?aid=xxx&amp;c=weicoabroad&amp;from=123&amp;gsid=_xxx&amp;i=xxx&amp;lang=zh_CN&amp;s=xxx&amp;ua=iPhone12%2C1_iOS14.0.1_Weibo_intl._4330_cell&amp;v_p=59</code></p>\n<p>在抓包结果请求头（地址 query 参数）里提取出aid、s、gsid 和 from 参数，组合成形如 <code>&quot;aid=xxx; s=xxx;gsid=xxx;from=xxx&quot;</code>的形式填入。</p>\n<p><code>COOKIE_KA</code> 用来追踪超话活动和自动提取兑换码。事实上会在抓取 <code>COOKIE_WEIBO</code>  的时候会一起被抓取到。注意 Cookie 需要<code>SUB</code>和<code>SUBP</code>两个字段。填写形式同 <code>COOKIE_WEIBO</code>。</p>\n<p>详细抓取教程可参考视频：<a href=\"https://b23.tv/3cj7vG\" target=\"_blank\">微博国际版iOS抓包教程</a></p>\n<h2 id=\"推送相关详解\">推送相关详解<a title=\"#推送相关详解\" href=\"#推送相关详解\"></a></h2>\n<p>在配置中，设置 <code>ONEPUSH</code> 变量开启推送。不支持同时使用多个推送。默认配置/格式如下：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;notifier&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;params&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;markdown&quot;</span><span class=\"punctuation\">:</span> <span class=\"keyword\">false</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>实际填写时请浓缩至一行，形如 <code>&#123;&quot;notifier&quot;:&quot;&quot;,&quot;params&quot;:&#123;&quot;markdown&quot;:false&#125;&#125;</code>。如果是本地配置，请使用单引号包裹。</p>\n<p><code>ONEPUSH</code> 根配置：</p>\n<ul>\n<li>notifier：推送名字，如 <code>bark</code>、<code>dingtalk</code>、<code>discord</code>、<code>pushplus</code>、<code>qmsg</code>、<code>serverchan</code>、<code>serverchanturbo</code>、<code>telegram</code>、<code>wechatworkapp</code>、<code>wechatworkbot</code>、<code>custom</code> 等。</li>\n<li>params：推送参数，如 <code>markdown</code>、<code>required</code>、<code>secret</code> 等。</li>\n</ul>\n<p>如使用 Discord Bot：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ONEPUSH=<span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;notifier&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;discord&quot;</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;params&quot;</span><span class=\"punctuation\">:</span><span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;markdown&quot;</span><span class=\"punctuation\">:</span><span class=\"keyword\">true</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;webhook&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;https://discord.com/api/webhooks/xxxxxx&quot;</span><span class=\"punctuation\">&#125;</span><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<details><summary>详细配置说明</summary><blockquote>\n<p>下列参数如果required字段包含 ‘title’ 或 ‘content’，ONEPUSH变量中都不需要设置。例如serverchan不需要设置 ‘title’。<br>\n此外 custom 方式暂时不支持推送签到结果。</p>\n</blockquote>\n<ul>\n<li>bark</li>\n</ul>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ONEPUSH=<span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;notifier&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;bark&quot;</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;params&quot;</span><span class=\"punctuation\">:</span><span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;markdown&quot;</span><span class=\"punctuation\">:</span><span class=\"keyword\">false</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;key&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;xxxxxx&quot;</span><span class=\"punctuation\">&#125;</span><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>custom</li>\n</ul>\n<p>该方式比较复杂：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;method&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;post&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;url&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;data&quot;</span><span class=\"punctuation\">:</span><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  </span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;retcode_key&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;retcode_value&quot;</span><span class=\"punctuation\">:</span><span class=\"number\">200</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;data_type&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;data&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;merge_title_and_desp&quot;</span><span class=\"punctuation\">:</span><span class=\"keyword\">false</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;set_data_title&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;set_data_sub_title&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;set_data_desp&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<div class=\"φbq\"><div class=\"φbs\"><table><thead>\n<tr>\n<th>配置项</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>method</td>\n<td>必填，请求方式。默认：post</td>\n</tr>\n<tr>\n<td>url</td>\n<td>必填，完整的自定义推送链接</td>\n</tr>\n<tr>\n<td>data</td>\n<td>选填，发送的data。默认为空，可自行添加额外参数</td>\n</tr>\n<tr>\n<td>retcode_key</td>\n<td>必填，响应体返回的状态码的 key</td>\n</tr>\n<tr>\n<td>retcode_value</td>\n<td>必填，响应体返回的状态码的 value</td>\n</tr>\n<tr>\n<td>data_type</td>\n<td>选填，发送data的方式，可选 params</td>\n</tr>\n<tr>\n<td>merge_title_and_desp</td>\n<td>选填，是否将标题（应用名 + 运行状态）和运行结果合并。默认：false</td>\n</tr>\n<tr>\n<td>set_data_title</td>\n<td>必填，推送方式 data 中消息标题的 key</td>\n</tr>\n<tr>\n<td>set_data_sub_title</td>\n<td>选填，推送方式 data 中消息正文的 key。有的推送方式正文的 key 有次级结构，需配合 set_data_title 构造子级，与 set_data_desp 互斥。例如：企业微信中，set_data_title 填 text，set_data_sub_title 填 content</td>\n</tr>\n<tr>\n<td>set_data_desp</td>\n<td>选填，推送方式 data 中消息正文的 key。例如：server 酱的为 desp，与 set_data_sub_title 互斥，两者都填则本项不生效</td>\n</tr>\n</tbody>\n</table></div></div><p>例如写一个 ServerChan 的自定义推送。</p>\n<p>查看文档得到 ServerChan 推送所需要的信息：</p>\n<ul>\n<li>需要的 <code>url</code>形式为：<code>https://sc.ftqq.com/&#123;SCKEY&#125;.send</code></li>\n<li>发送的 <code>data</code>形式为：<code>&#123;'text': test','desp':desp&#125;</code></li>\n<li>消息发送成功响应体为：<code>&#123;'errno': 0, 'errmsg': 'OK'&#125;</code></li>\n</ul>\n<p>自定义推送配置如下：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;method&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;post&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;url&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;https://sc.ftqq.com/&#123;直接填写你的SCKEY&#125;.send&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;data&quot;</span><span class=\"punctuation\">:</span><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  </span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;retcode_key&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;errno&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;retcode_value&quot;</span><span class=\"punctuation\">:</span><span class=\"number\">0</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;data_type&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;data&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;merge_title_and_desp&quot;</span><span class=\"punctuation\">:</span><span class=\"keyword\">true</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;set_data_title&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;test&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;set_data_sub_title&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;set_data_desp&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;desp&quot;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>dingtalk</li>\n</ul>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ONEPUSH=<span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;notifier&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;dingtalk&quot;</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;params&quot;</span><span class=\"punctuation\">:</span><span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;markdown&quot;</span><span class=\"punctuation\">:</span><span class=\"keyword\">true</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;token&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;xxxxxx&quot;</span><span class=\"punctuation\">,</span>secret<span class=\"punctuation\">:</span><span class=\"string\">&quot;xxxxxx&quot;</span><span class=\"punctuation\">&#125;</span><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>discord</li>\n</ul>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ONEPUSH=<span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;notifier&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;discord&quot;</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;params&quot;</span><span class=\"punctuation\">:</span><span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;markdown&quot;</span><span class=\"punctuation\">:</span><span class=\"keyword\">true</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;webhook&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;https://discord.com/api/webhooks/xxxxxx&quot;</span><span class=\"punctuation\">&#125;</span><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>pushplus</li>\n</ul>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ONEPUSH=<span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;notifier&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;pushplus&quot;</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;params&quot;</span><span class=\"punctuation\">:</span><span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;markdown&quot;</span><span class=\"punctuation\">:</span><span class=\"keyword\">true</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;token&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;xxxxxx&quot;</span><span class=\"punctuation\">&#125;</span><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>qmsg</li>\n</ul>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ONEPUSH=<span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;notifier&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;qmsg&quot;</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;params&quot;</span><span class=\"punctuation\">:</span><span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;markdown&quot;</span><span class=\"punctuation\">:</span><span class=\"keyword\">false</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;key&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;xxxxxx&quot;</span><span class=\"punctuation\">&#125;</span><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>serverchan</li>\n</ul>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ONEPUSH=<span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;notifier&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;serverchan&quot;</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;params&quot;</span><span class=\"punctuation\">:</span><span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;markdown&quot;</span><span class=\"punctuation\">:</span><span class=\"keyword\">true</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;sckey&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;xxxxxx&quot;</span><span class=\"punctuation\">&#125;</span><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>serverchanturbo</li>\n</ul>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ONEPUSH=<span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;notifier&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;serverchanturbo&quot;</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;params&quot;</span><span class=\"punctuation\">:</span><span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;markdown&quot;</span><span class=\"punctuation\">:</span><span class=\"keyword\">true</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;sctkey&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;xxxxxx&quot;</span><span class=\"punctuation\">&#125;</span><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>telegram</li>\n</ul>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ONEPUSH=<span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;notifier&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;telegram&quot;</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;params&quot;</span><span class=\"punctuation\">:</span><span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;markdown&quot;</span><span class=\"punctuation\">:</span><span class=\"keyword\">false</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;token&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;xxxxxx&quot;</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;userid&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;xxxxxx&quot;</span><span class=\"punctuation\">&#125;</span><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>wechatworkapp</li>\n</ul>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ONEPUSH=<span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;notifier&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;wechatworkapp&quot;</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;params&quot;</span><span class=\"punctuation\">:</span><span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;markdown&quot;</span><span class=\"punctuation\">:</span><span class=\"keyword\">true</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;corpid&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;xxxxxx&quot;</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;corpsecret&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;xxxxxx&quot;</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;agentid&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;xxxxxx&quot;</span><span class=\"punctuation\">&#125;</span><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>wechatworkbot</li>\n</ul>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ONEPUSH=<span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;notifier&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;wechatworkbot&quot;</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;params&quot;</span><span class=\"punctuation\">:</span><span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;markdown&quot;</span><span class=\"punctuation\">:</span><span class=\"keyword\">true</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;key&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;xxxxxx&quot;</span><span class=\"punctuation\">&#125;</span><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n</details>","next":{"title":"Hexo 主题之 Inside 拓展篇","link":"post/hexo-inside"},"plink":"https://blog.cworld.top/post/mihoyo-helper/","toc":[{"id":"项目相关","title":"项目相关","index":"1","children":[{"id":"前言","title":"前言","index":"1.1"},{"id":"简介","title":"简介","index":"1.2"},{"id":"功能支持","title":"功能支持","index":"1.3"},{"id":"源码","title":"源码","index":"1.4"}]},{"id":"运行方式与环境搭建","title":"运行方式与环境搭建","index":"2"},{"id":"配置与操作","title":"配置与操作","index":"3","children":[{"id":"配置项","title":"配置项","index":"3.1"},{"id":"配置文件","title":"配置文件","index":"3.2"},{"id":"获取-cookie","title":"获取 Cookie","index":"3.3"}]},{"id":"签到相关详解","title":"签到相关详解","index":"4","children":[{"id":"原神、崩坏3、米游社签到","title":"原神、崩坏3、米游社签到","index":"4.1"},{"id":"微博超话签到","title":"微博超话签到","index":"4.2"}]},{"id":"推送相关详解","title":"推送相关详解","index":"5"}],"reward":true,"copyright":{"updated":"2022年11月9日","author":"CWorld","link":"<a href=\"https://blog.cworld.top/post/mihoyo-helper/\" title=\"米哈游游戏（原神/崩坏3）自动签到\">https://blog.cworld.top/post/mihoyo-helper/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" rel=\"external nofollow noopener\" target=\"_blank\">CC BY-NC-ND 4.0</a>)"},"reading_time":"2728 字约 18 分钟"}